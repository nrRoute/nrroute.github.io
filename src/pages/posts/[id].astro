---
import { getCollection, render } from "astro:content";
import type { CollectionEntry } from "astro:content";
import Prose from "../../components/Prose.astro";
import Layout from "../../layouts/Layout.astro";

type Props = CollectionEntry<"blog">;

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map(post => ({
    params: { id: post.id },
    props: post,
  }));
}

const post = Astro.props;

const dateFormatter = new Intl.DateTimeFormat("ja-JP", {
  dateStyle: "medium",
});

const formattedCreated = dateFormatter.format(post.data.created);

const formattedModified = dateFormatter.format(post.data.modified);

const { Content } = await render(post);
---

<Layout title={post.data.title} description={post.data.description}>
	<div class="card w-auto dark:card-dark">
		<div class="relative flex items-center justify-center">
			<h1 class="mb-3 text-2xl font-medium">
				{post.data.title}
			</h1>
		</div>
		<div class="grid grid-cols-2 text-center">
			<div>作成日: {formattedCreated}</div>
			{
				post.data.modified ? <div>更新日: {formattedModified}</div> : ""
			}
		</div>
	</div>
	<div id="content" class="border-b-2 border-current">
		<Prose>
			<Content />
		</Prose>
	</div>
	<div class="my-5 ml-auto px-3">
		<a href="/posts">記事一覧に戻る</a>
	</div>
</Layout>
