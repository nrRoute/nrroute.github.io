---
title: グラフ理論まとめ
created: 2025-07-31
tags:
- graph-theory
- summary
modified: 2025-08-01
---

# 基礎的な事項

## 隣接行列

頂点どうしの隣接関係を行列にしたもの。自分自身とは隣接しないので、対角成分は0。

## 接続行列

頂点と辺の接続関係を行列にしたもの。頂点と辺に適当に番号を振って、行を頂点、列を辺として頂点 $i$ と辺 $j$ が接続していたら $(i,j)=1$ とする。

## 同型

二つのグラフ $G=(V,E),G'=(V',E')$ を単純グラフとすると、$G$ の任意の2頂点 $v,w\in V$ に対して、$(v,w)\in E$ となるのが、$(f(v),f(w))\in E'$ となるとき、かつそのときに限るような $V$ から $V'$ への全単射写像 $f$ が存在するとき、
$G, G'$ は同型という。同型性判定問題はNPらしい。

## オイラーの公式

平面グラフの頂点の数を $n$、辺の数を $m$、面の数を $h$ とおくと、

$$
n + h = m - 2
$$

である。

$$
m - n - h = 2
$$

と覚えてしまった方が、符号を忘れた時に平面グラフを書いて2になるように調整して公式を導出できそう。

## 正則グラフ

すべての頂点の次数が同じグラフ。

# オイラー回路、ハミルトン回路

## オイラー回路

すべての枝をちょうど1回ずつ通る閉路。オイラー回路を持つ必要十分条件は、すべての頂点の次数が偶数であること。

### 証明

- $\implies$: 回路を回ると、始点でまず枝を1本使う。途中の頂点を通るたびに枝を2本使う。最後に終点で1本使う。
- $\impliedby$: 始点から出発して、回路を構築していく。ある頂点に着く時、枝は奇数本しか使っていないので、かならず出ていくのに使える枝がある。始点に戻ってきた時、まだ使っていない枝があれば、それを使って同じことをする。なければそれが回路。

## ハミルトン閉路

すべての頂点をちょうど1回ずつ通る閉路。

### Diracの定理

ハミルトン閉路を持つことの同値条件。頂点の次数が... (TODO)

### Oreの定理

Diracの定理の強い版。任意の2頂点に対して、次数の和が頂点の数以上であることと、ハミルトン閉路を持つことが同値というもの。
証明が重要。

条件を満たしているがハミルトン閉路を持たないグラフ $G=(V,E)$ がについて、$G$ ハミルトン閉路をもたないように $G$ に枝を足していく。ギリギリまで足したときに得られるグラフを $G'$ とする。
$G'$ に枝を一本でも足してしまうと、ハミルトン閉路ができてしまうので、$G'$ はすべての頂点を通る道が存在する。これを順に $v_1,v_2,...,v_n$ とする。$G'$ はハミルトン閉路を持たないので、$(v_1, v_n)$ は存在しない。
いっぽう、$(v_1,v_2), (v_{n-1},v_n)$ は存在する。Oreの定理の条件から、$(v_1,v_3), ..., (v_1, v_{n-1}), (v_n,v_2), ..., (v_n,v_{n-2})$ のうち少なくとも $n-2$ 本の枝が存在する。
すると、$v_1$ から出ている枝が $m$ 本だとすると、$v_n$ から出ている枝は少なくとも $n-m-2$ 本である。頂点の数は $n-3$ 個だから、
鳩の巣原理から、$(v_1,v_i), (v_n,v_{i-1})$ が存在する $(3\le i \le n-1)$。これにより、閉路が存在する。よって条件を満たしているがハミルトン閉路を持たないグラフはない。

# 最小全域木

## クラスカルのアルゴリズム

枝を重さの小さい順に閉路ができないように追加していく。貪欲法。頂点を追加するのはプリム。証明は、（より）最小（な）全域木 $T'$ が存在するとして、矛盾を導く。

# ダイクストラ法

[nr-lecture-memo/ダイクストラ法](https://scrapbox.io/nr-lecture-memo/%E3%83%80%E3%82%A4%E3%82%AF%E3%82%B9%E3%83%88%E3%83%A9%E6%B3%95)

# 最大流問題

## 残余ネットワーク

$(u,v)$ について、$u\to v$ に残り流せる量を書き、$v\to u$ に戻せる量（つまり流した量）を書く。

## フォード・ファルカーソン法

まず適当なフローを与える。それを元に残余ネットワークをつくり、残余ネットワーク上で始点から終点への道（増大道）を見つける。これの弧のうち最小値分のフローをこの道に流す。
フローと残余ネットワークを更新し（重さが0になった弧は消す）、これ以上流せなくなる（増大道がなくなる）まで更新する。

## 最小カット・最大フローの定理

最小カット = 最大フロー

# 頂点彩色、辺彩色

## ブルックスの定理
